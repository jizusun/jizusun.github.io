---
layout: post
title:  "改造路由器实现“无痛的科学上网”——其实没那么难"
categories: blogs
author: "孙继祖"
---

# Table of Content
{:.no_toc}

- TOC
{:toc}

## 效果实测

下图是网速实测。上方是浏览器直连改造后的路由器，下方是浏览器通过本机运行的代理客户端上网。

本着“只选对的，不选贵的”的原则，我目前正在使用的（也是本文即将介绍的）路由器是一个很古老的电子设备，大概是2010年左右的产品（Broadcom BCM6358解决方案）。因为家里用的是几户人家共享的宽带，所以网速也没有那么快，实测看来网速没有显著影响。

![image](https://user-images.githubusercontent.com/4011348/44300952-b6cead80-a341-11e8-824f-ac737cc2a485.png)

## 知识准备

### 什么是“无痛的科学上网”
* 科学上网：又称“翻墙”、“使用代理上网”，指采用科学的手段绕过 GFW 的封锁，访问那些据说“不存在”的网站
* 无痛的科学上网：又称“透明代理”，指对上网终端设备（手机、电脑、电视盒子等）不需要额外的设置，即可以实现科学上网
* 为什么需要：“因为梯子（对所有终端透明）是既空气, 水和WIFI以后程序狗的第四大需求啊....” （<https://www.zhihu.com/question/29475642/answer/44549382>）

### “从放弃到入门”？对，其实没那么难！
改造路由器？乍一看可能会觉得很复杂，但如果具备足够的知识，其实改造起来很容易，或者买现成改造好的方案。

笔者的经历就是一个“从放弃到入门”的例子，目前使用的路由器 HG555a大概购于5年前，买了之后立马刷上了OpenWRT，但是刷了之后路由器不太稳定（怀疑当时刷了错误版本的固件），于是开始吃灰。2年前毕业，因为心怀一颗折腾的心，所以没舍得扔。一年前重新刷机，发现其实很稳定，但配置Shadowsocks插件没有成功，于是当作普通的路由器用。一个月前，改为配置 ShadowsocksR 插件，依然没有成功，还自己交叉编译了适合本级的 ipk 文件。一天前的晚上，心有不甘，继续折腾，因为

其实只需要三步
1. 路由器刷机：可选固件 OpenWRT（新版叫 LEDE），Merlin（梅林），老毛子Padavan ，DD-WRT，Tomato等
2. 路由器安装翻墙插件（客户端）：Shadowsocks, ShadowsockR, V2Ray 等
3. 配置代理帐号（代理服务器信息）：自行搭建代理服务器，或者购买

### 可选的改造方案

* 软件改造：本文所述
* 硬件改造：此部分已经超出了我的理解范围，动手能力强的同学可以自行搜索改造方案，或者找淘宝店）

如何选择？

* 如果你恰好有一个和我一样型号的路由器 Huawei HG556a(<https://wiki.openwrt.org/toh/huawei/hg556a>)，那么可以用我编译好的 ShadowsocksR 插件(<https://github.com/ywb94/openwrt-ssr/issues/189>)
* 如果你有一个路由器，且它支持OpenWRT系统（你可以尝试搜索“路由器型号 Openwrt”），那么你可以参考我的步骤进行改造，或找淘宝店家帮忙改造
* 如果你有一个路由器，但不再OpenWRT支持设备列表内，那么你可以考虑再买一个路由器
* 购买一个支持OpenWRT的路由器
  * 淘宝购买二手路由器，并请店家刷好系统
  * 淘宝购买全新路由器，并请店家刷好系统
  * 京东等购买自带类OpenWRT的全新路由器，免去自己刷机的步骤
  * 京东等购买全新路由器，并自己刷机

### 什么是OpenWRT（LEDE）

* OpenWrt: <https://openwrt.org/about>
* LEDE 17.01 "Reboot": <https://openwrt.org/releases/17.01/start>


## 如何寻找刷机资源

因为目前路由器解决方案的解决方案主要是 Qualcomm（高通），Broadcom（博通）和 MediaTek（联发科）几家 [^cfan-soc] [^smzdm-soc] 
，所以第一手资料主要是英文的。国内的论坛上也有一些原创内容，但毕竟水贴毕竟多。

### 首选：官网（英文）

前一段百度被网民们黑得够惨，不过在英文搜索方面，百度确实比 Google 差很远。

### 其次：各种论坛和博客（中文）

## 刷入第三方系统（OpenWRT）

### 稳定放心：官方固件

### 功能丰富：第三方固件

## 安装插件（ipk格式）

### 首选：别人编译好的安装包

一般是在 GitHub 上开源的插件，在 Release 页下载。

### 其次：自己进行编译

## 配置代理帐号（ShadowsockR）

### 快捷：网上购买


### 稳定：自行搭建

## 扩展阅读

[^cfan-soc]: [路由器芯的秘密全在这里了！](http://www.cfan.com.cn/2017/1115/129723.shtml)

[^smzdm-soc]: [看“芯”识Router，讲解中高端WiFi Soc的无线路由器选购技巧](https://post.smzdm.com/p/433680/)